{% extends "base.html" %}

{% block content %}
<div class="container">
	<div class="elements">
		<h2>{{ post.title }}</h2>
		<p>By <a href="{% url 'profile' post.author.username %}">{{ post.author }} </a>| {{ post.created_at|date:"F j, Y, g:i a" }}</p>
		<p>{{ post.content }}</p>
	</div>

	{% if request.user == post.author or request.user.is_staff %}
		<div class="elements">
			<a href="{% url 'post-edit' post.id %}" class="btn">Edit Post</a>
				<form action="{% url 'post-delete' post.id %}" method="POST" style="display:inline;">
				{% csrf_token %}
				<button type="submit" class="btn">Delete Post</button>
			</form>
		</div>
	{% endif %}

	<div class="elements">
		<h3>Comments</h3>
		<ul class="list-group">
			{% for comment in post.comments.all %}
				<li class="comment">
					<p>{{ comment.content }}</p>
					<small>By <a href="{% url 'profile' comment.author.username %}">{{ comment.author.username }}</a> | {{ comment.created_at|date:"F j, Y, g:i a" }}</small>
				</li>
			{% empty %}
				<li class="list-group-item">No comments yet. Be the first to comment!</li>
			{% endfor %}
		</ul>
	</div>

	<div class="elements">
		<h4>Add a Comment</h4>
		{% if user.is_authenticated %}
		<form action="{% url 'add-comment' post.id %}" method="POST">
			{% csrf_token %}
			<div class="form-group">
				<textarea name="content" class="form-control" rows="3" required></textarea>
			</div>
			<button type="submit" class="btn">Submit Comment</button>
		</form>
		{% else %}
		<div>
			Please login to add a comment
		</div>
		{% endif %}
	</div>

	<a href="{% url 'post-list' %}" class="btn btn-secondary mt-3">Back to All Posts</a>
</div>
{% endblock content %}